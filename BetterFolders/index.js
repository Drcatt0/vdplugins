(function(p,r,s,e){"use strict";const{getGuildFolders:g}=s.findByStoreName("UserSettingsProtoStore"),{isFolderExpanded:L}=s.findByStoreName("ExpandedGuildFolderStore"),toggleAutoCollapse=()=>{const currentExpanded=g().filter(t=>t.folderId&&L(t.folderId));if(currentExpanded.length>1){currentExpanded.forEach((t,i)=>{if(i>0){e.FluxDispatcher.dispatch({type:"TOGGLE_GUILD_FOLDER_EXPAND",folderId:t.folderId})}})}};const FolderAutoCollapse=()=>{const onFolderToggle=a=>{let{folderId:id}=a;if(r.storage.autoCollapse&&L(id)){toggleAutoCollapse()}};e.FluxDispatcher.subscribe("TOGGLE_GUILD_FOLDER_EXPAND",onFolderToggle);return()=>e.FluxDispatcher.unsubscribe("TOGGLE_GUILD_FOLDER_EXPAND",onFolderToggle)};const hideCollapsedFolders=()=>{const folders=g().filter(t=>t.folderId&&!L(t.folderId));folders.forEach(folder=>{e.FluxDispatcher.dispatch({type:"HIDE_GUILD_ICONS",folderId:folder.folderId})})};var j={onLoad:function(){r.storage.autoCollapse??=true;r.storage.hideIcons??=false;this.unsubFolderToggle=FolderAutoCollapse();this.hideIconsFn=r.storage.hideIcons?hideCollapsedFolders:null;if(this.hideIconsFn){this.hideIconsFn()}},onUnload:function(){this.unsubFolderToggle&&this.unsubFolderToggle()},settings:()=>s.createElement(e.ScrollView,null,s.createElement(e.FormSection,{title:"Folder Options"},s.createElement(e.FormRow,{label:"Auto-collapse folders",trailing:s.createElement(e.FormSwitch,{value:r.storage.autoCollapse,onValueChange:value=>{r.storage.autoCollapse=value}})}),s.createElement(e.FormRow,{label:"Hide icons in collapsed folders",trailing:s.createElement(e.FormSwitch,{value:r.storage.hideIcons,onValueChange:value=>{r.storage.hideIcons=value;if(value){hideCollapsedFolders()}})}))))};return p.default=j,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.plugin,vendetta.metro,vendetta.ui.components,vendetta.metro.common);
