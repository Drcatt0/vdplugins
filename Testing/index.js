(function(f,L,g,t,B,C,c,d,F,D,G,k,O,E){"use strict";const H="https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=";var w={translate:async function(e,targetLang="en"){try{const url=`${H}${targetLang}&dt=t&q=${encodeURIComponent(e)}`,response=await fetch(url);const result=await response.json();return result[0]?.[0]?.[0]||"Translation error"}catch(n){console.error("Google Translate fetch error:",n);throw Error("Failed to fetch from Google Translate")}}};let T=[];function K(){return B.before("openLazy",g.findByProps("openLazy","hideActionSheet"),function(e){let[a,i,s]=e;if(i!=="MessageLongPressActionSheet")return;a.then(function(A){B.after("default",A,function(_,component){let msg=_[0]?.message;if(!msg)return;const v=g.findByStoreName("MessageStore").getMessage(msg.channel_id,msg.id);const btnText=T.find(item=>item[msg.id])?"Revert":"Translate";component.props.children.push(t.React.createElement(d.Forms.FormRow,{label:btnText+" Message",onPress:async()=>{try{const lang=t.React.useProxy(L.storage).target_lang||"en",text=T.find(item=>item[msg.id])?T.find(item=>item[msg.id]).original:msg.content,translated=await w.translate(text,lang);if(translated!=="Translation error"){T=btnText==="Translate"?[{[msg.id]:{original:msg.content}}]:T.filter(item=>!item[msg.id]);t.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...v,content:btnText==="Translate"?translated:text},log_edit:!1})}}catch(error){console.error("Translation error:",error)}}}))})})})}var N;(function(e){e[e.BUILT_IN=0]="BUILT_IN"})(N||(N={}));var p;(function(e){e[e.STRING=3]="STRING"})(p||(p={}));function q(){return G.registerCommand({name:"translate",displayName:"translate",type:N.BUILT_IN,options:[{name:"text",displayName:"text",type:p.STRING,required:!0},{name:"language",displayName:"language",type:p.STRING,required:!0}],execute:async function(e,a){const[i,s]=e;try{const result=await w.translate(i.value,s.value);return{content:result}}catch(error){console.error("Translation command error:",error);return{content:"Translation failed."}}}})}let settings=[];var plugin={onLoad:function(){return settings=[K(),q()]},onUnload:function(){settings.forEach(e=>e&&e())}};return f.default=plugin,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta,vendetta.commands,vendetta.storage);
